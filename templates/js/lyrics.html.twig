{% extends '@EasyAdmin/layout.html.twig' %}

{% block body %}
<div class="card h-100 shadow-sm">


    {# Header #}
    <div class="card-header fw-bold text-truncate" title="{{ hit.title }}">
        {{ hit._highlightResult.title.value|raw }}
    </div>

    {# Body #}
    <div class="card-body small">

{# Display ChordPro metadata if available #}
        {% if hit.title %}
            <div class="mb-2">
                <strong>Title:</strong> {{ hit.title }}
            </div>
        {% endif %}

        {% if hit.artist %}
            <div class="mb-2">
                <strong>Artist:</strong> {{ hit.artist }}
            </div>
        {% endif %}

        {% if hit.key %}
            <div class="mb-2">
                <strong>Key:</strong> {{ hit.key }}
            </div>
        {% endif %}

        {# Display formatted lyrics with chords #}
        {% if hit.text %}
            <div class="lyrics-display">
                <pre class="lyrics-content">{{ hit.text|escape }}</pre>
            </div>
        {% endif %}

        {# Fallback to legacy lyrics array for backward compatibility #}
        {% if not hit.text and hit.lyrics %}
            <ul>
                {% for line in hit.lyrics %}
                    <li>
                        {{ line }}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

{#        #}{# ---------- Year (hide 0/empty) ---------- #}
{#        </div>#}
    </div>

    {# Footer #}
    <div class="card-footer d-flex justify-content-between align-items-center small">
        {{ hit.parent }}
        {{ hit.code }}
    <span class="text-muted">
      {{ hit._highlightResult.type.value|default(hit.type) }}
        {% if hit._rankingScore != 1 %}
            â€¢ score: {{ hit._rankingScore|number_format(2) }}
        {% endif %}
    </span>

        <button
            class="btn btn-sm btn-outline-primary"
            data-action="survos--meili-bundle--json#modal"
            data-hit-id="{{ hit.code }}"
        >
            <span class="me-1 icon-wrapper">{{ icons.json|raw }}</span> JSON
        </button>
    </div>
</div>

{% endblock %}
