version: '3.7'
services:
    database:
        image: 'postgres:alpine'
        environment:
            POSTGRES_PASSWORD: main
            POSTGRES_USER: main
            POSTGRES_DB: main
        ports:
            # To allow the host machine to access the ports below, modify the lines below.
            # For example, to allow the host to connect to port 3306 on the container, you would change
            # "3306" to "3306:3306". Where the first port is exposed to the host and the second is the container port.
            # See https://docs.docker.com/compose/compose-file/compose-file-v3/#ports for more information.
            - '5432'

    rabbitmq:
        image: rabbitmq:3-management-alpine
        container_name: 'rabbitmq'
        ports:
            - 5672:5672
            - 15672:15672
        volumes:
            - ~/.docker-conf/rabbitmq/data/:/var/lib/rabbitmq/
            - ~/.docker-conf/rabbitmq/log/:/var/log/rabbitmq
        networks:
            - rabbitmq_go_net

###> meilisearch/search-bundle ###
    meilisearch:
      image: getmeili/meilisearch:${MEILISEARCH_VERSION:-v1.0}
      environment:
        # You should definitely change the master key in production
        MEILI_MASTER_KEY: ${MEILI_MASTER_KEY:-!ChangeMe!}
      volumes:
        - meilisearch_data:/meili_data
###< meilisearch/search-bundle ###

networks:
    rabbitmq_go_net:
        driver: bridge

volumes:
###> meilisearch/search-bundle ###
  meilisearch_data:
###< meilisearch/search-bundle ###
